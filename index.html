<!DOCTYPE html>
<html lang="zh-CN">
<head>
<!--[if lt IE 9]>
        <style>body {display: none; background: none !important} </style>
        <meta http-equiv="Refresh" Content="0; url=//outdatedbrowser.com/" />
    <![endif]-->
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<meta name="format-detection" content="telephone=no">
<meta name="author" content="Zane.Xie">


    
    


<meta name="description" content="这是Zane.Xie">
<meta property="og:type" content="website">
<meta property="og:title" content="Zane`s Blog 随心记录">
<meta property="og:url" content="http://blog.codesay.top/index.html">
<meta property="og:site_name" content="Zane`s Blog 随心记录">
<meta property="og:description" content="这是Zane.Xie">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Zane`s Blog 随心记录">
<meta name="twitter:description" content="这是Zane.Xie">

<link rel="apple-touch-icon" href="/apple-touch-icon.png">


    <link rel="alternate" href="/atom.xml" title="Zane`s Blog 随心记录" type="application/atom+xml">



    <link rel="shortcut icon" href="/favicon.png">



    <link href="//cdn.bootcss.com/animate.css/3.5.1/animate.min.css" rel="stylesheet">



    <link href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet">



    <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/blue/pace-theme-minimal.css" rel="stylesheet">


<link rel="stylesheet" href="/css/style.css">


    <style> .article { opacity: 0;} </style>


<link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">


<title>Zane`s Blog 随心记录</title>

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>

<script>
    var yiliaConfig = {
        fancybox: true,
        animate: true,
        isHome: true,
        isPost: false,
        isArchive: false,
        isTag: false,
        isCategory: false,
        fancybox_js: "//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js",
        scrollreveal: "//cdn.bootcss.com/scrollReveal.js/3.1.4/scrollreveal.min.js",
        search: undefined
    }
</script>


    <script> yiliaConfig.jquery_ui = [false]; </script>



    <script> yiliaConfig.rootUrl = "\/";</script>






</head></html>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            <img src="/img/avatar.png" class="animated zoomIn">
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/">Zane.Xie</a></h1>
        </hgroup>

        
        <p class="header-subtitle">博主码农出身，入行十余载，学艺虽不精，但不乏实践思考，在此记录之！</p>
        

        


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">主页</a></li>
                        
                            <li><a href="/archives/">所有文章</a></li>
                        
                            <li><a href="/tags/">标签云</a></li>
                        
                            <li><a href="/about/">关于我</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" href="mailto:xzyeah@qq.com" title="Email"></a>
                            
                                <a class="fa GitHub" href="#" title="GitHub"></a>
                            
                                <a class="fa RSS" href="/atom.xml" title="RSS"></a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/BeanValidate/">BeanValidate</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Git/">Git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GitLab/">GitLab</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Github/">Github</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hexo/">Hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/IntelliJ-IDEA/">IntelliJ IDEA</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Node-js/">Node.js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Oracle/">Oracle</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PL-SQL/">PL/SQL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cron/">cron</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python2/">python2</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python3/">python3</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/redis/">redis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/代码质量/">代码质量</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/后台校验/">后台校验</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/架构/">架构</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/系统设计/">系统设计</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/设计/">设计</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/设计模式/">设计模式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/重构/">重构</a></li></ul>
                    </div>
                </section>
                
                
                

                
                
                <section class="switch-part switch-part3">
                
                    <div id="js-aboutme">博主码农出身，入行十余载，学艺虽不精，但不乏实践思考，在此记录之！</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">Zane.Xie</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img src="/img/avatar.png" class="animated zoomIn">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">Zane.Xie</a></h1>
            </hgroup>
            
            <p class="header-subtitle">博主码农出身，入行十余载，学艺虽不精，但不乏实践思考，在此记录之！</p>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">主页</a></li>
                
                    <li><a href="/archives/">所有文章</a></li>
                
                    <li><a href="/tags/">标签云</a></li>
                
                    <li><a href="/about/">关于我</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" target="_blank" href="mailto:xzyeah@qq.com" title="Email"></a>
                            
                                <a class="fa GitHub" target="_blank" href="#" title="GitHub"></a>
                            
                                <a class="fa RSS" target="_blank" href="/atom.xml" title="RSS"></a>
                            
                        </ul>
            </nav>
        </header>                
    </div>
    <link class="menu-list" tags="标签" friends="友情链接" about="关于我">
</nav>
      <div class="body-wrap"><article id="post-aliyun-linux-cron任务执行问题解决过程记录与思考" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/06/28/aliyun-linux-cron任务执行问题解决过程记录与思考/" class="article-date">
      <time datetime="2017-06-28T02:07:30.000Z" itemprop="datePublished">2017-06-28</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        <h1 itemprop="name">
      <a class="article-title" href="/2017/06/28/aliyun-linux-cron任务执行问题解决过程记录与思考/">aliyun linux cron任务执行问题解决过程记录与思考</a>
    </h1>
      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="背景介绍"><a href="#背景介绍" class="headerlink" title="背景介绍"></a>背景介绍</h2><p>近期在一项目研发过程中，使用kettle进行数据的同步工作，在开发测试环境与UAT环境使用cron定时2分钟执行一次时都可以正常执行，而正式部署到aliyun上时，发现数据不能正常同步。</p>
<blockquote>
<p>重要配置信息</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">~</span><br><span class="line">[tomcat@iZwz9heyx5d32p6w76hbd6Z ETL]$ pwd</span><br><span class="line">/home/tomcat/ETL</span><br><span class="line">[tomcat@iZwz9heyx5d32p6w76hbd6Z ETL]$ ll</span><br><span class="line">total 148</span><br><span class="line">-rw-r--r-- 1 tomcat tomcat 124416 Jun 29 10:59 ETL-kq.tar</span><br><span class="line">drwxrwxr-x 2 tomcat tomcat   4096 Jun  7 17:00 logs</span><br><span class="line">drwxrwxr-x 2 tomcat tomcat   4096 Jun 29 13:49 sync_kq_signlog</span><br><span class="line">-rwxrwxr-x 1 tomcat tomcat    191 Jun 30 09:49 sync_kq_signlog_1.sh</span><br><span class="line">-rwxrwxrwx 1 tomcat tomcat    301 Jun 29 17:46 sync_kq_signlog.sh</span><br><span class="line">drwxrwxr-x 2 tomcat tomcat   4096 Jun 29 11:00 sync_kq_userdata</span><br><span class="line">-rwxrwxr-x 1 tomcat tomcat    305 Jun 29 17:46 sync_kq_userdata.sh</span><br><span class="line">[tomcat@iZwz9heyx5d32p6w76hbd6Z ETL]$ crontab -l</span><br><span class="line">*/1 * * * * sh /home/tomcat/ETL/sync_kq_userdata.sh</span><br><span class="line">*/2 * * * * sh  /home/tomcat/ETL/sync_kq_signlog.sh</span><br><span class="line"></span><br><span class="line">[tomcat@iZwz9heyx5d32p6w76hbd6Z ETL]$ vi sync_kq_signlog_1.sh</span><br><span class="line"></span><br><span class="line">#!/bin/sh</span><br><span class="line"></span><br><span class="line">/home/tomcat/kettle/kettle-5.2.0.0-209/data-integration/kitchen.sh /norep -file=/home/tomcat/ETL/sync_kq_signlog/kq_user_signlog.kjb &gt; /home/tomcat/ETL/logs/sync_kq_signlog.log</span><br><span class="line"></span><br><span class="line">~</span><br></pre></td></tr></table></figure>
<h2 id="处理过程"><a href="#处理过程" class="headerlink" title="处理过程"></a>处理过程</h2><ol>
<li><p>因为在uat环境运行的很好，所以第一步就去检查了所有的配置信息，未发现问题。</p>
</li>
<li><p>直接执行.sh脚本发现数据正常同步，初步怀疑crontab配置不对。</p>
</li>
<li><p>因为crontab配置也是从uat环境复制过来，未发现问题，习惯性的去除空格回车再加上。</p>
</li>
<li><p>使用root账号重启crond服务，查看sh脚本中所写的日志，发现仍然没有kettle执行日志，因此还是觉得cron没有执行，但查不到原因。</p>
</li>
<li><p>搜索cron不执行原因，没有太多有价值的资料，了解到一些cron配置与日志查看命令。</p>
</li>
<li><p>检查脚本发现etl log输出为&gt;到文件，忽略了日志被覆盖情况，发现始终有一条日志，改为&gt;&gt; , 考虑cron正常运行，sh脚本问题。</p>
</li>
<li><p>根据掌握的命令查看cron日志，确认cron有正常执行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[tomcat@iZwz9heyx5d32p6w76hbd6Z ETL]$ tail -f /var/log/cron</span><br><span class="line">Jun 30 10:52:01 iZwz9heyx5d32p6w76hbd6Z CROND[28777]: (tomcat) CMD (sh /home/tomcat/ETL/sync_kq_userdata.sh)</span><br><span class="line">Jun 30 10:53:01 iZwz9heyx5d32p6w76hbd6Z CROND[28901]: (tomcat) CMD (sh /home/tomcat/ETL/sync_kq_userdata.sh)</span><br><span class="line">Jun 30 10:54:01 iZwz9heyx5d32p6w76hbd6Z CROND[28987]: (tomcat) CMD (sh  /home/tomcat/ETL/sync_kq_signlog.sh)</span><br><span class="line">Jun 30 10:54:01 iZwz9heyx5d32p6w76hbd6Z CROND[28988]: (tomcat) CMD (sh /home/tomcat/ETL/sync_kq_userdata.sh)</span><br></pre></td></tr></table></figure>
</li>
<li><p>搜索cron 情况下sh不执行的原因， 注意到有环境变量的原因</p>
</li>
<li><p>shell脚本上加上env &gt; xxx.log，输出log查看，发现环境变量存在问题</p>
</li>
<li><p>在sh脚本中加上环境变更，查看日志与执行结果，正常执行。</p>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">[tomcat@iZwz9heyx5d32p6w76hbd6Z ETL]$ cat sync_kq_signlog.sh</span><br><span class="line">#!/bin/sh</span><br><span class="line"></span><br><span class="line">PATH=/usr/java/jdk1.7.0_79/bin:/usr/local/bin:/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/sbin:/home/tomcat/bin</span><br><span class="line"></span><br><span class="line">/home/tomcat/kettle/kettle-5.2.0.0-209/data-integration/kitchen.sh /norep -file=/home/tomcat/ETL/sync_kq_signlog/kq_user_signlog.kjb &gt; /home/tomcat/ETL/logs/sync_kq_signlog.log</span><br></pre></td></tr></table></figure>
<h2 id="总结思考"><a href="#总结思考" class="headerlink" title="总结思考"></a>总结思考</h2><p>看了上面的处理过程，可以发现经过了很多步骤，比较曲折，也花费了不少的时间。</p>
<p>事后总结一下，发现主要存在的问题有以下几点：</p>
<ol>
<li>重要结论的判定不严谨，导致问题定位错误，走了弯路<br> 对cron是否有执行的判断，依据不足</li>
<li>很多时候过度依赖经验和搜索引擎，对问题判断不清</li>
<li>对不熟悉的工具或内容有点想当然，没有深究</li>
</ol>
<p>改进方法：<br>严格按照问题定位处理方法进行</p>
<ol>
<li>初步列出问题可能产生的原因</li>
<li>按照优先级对原因进行排序</li>
<li>确认原因排查的严谨方法</li>
<li>逐一排查，验证</li>
</ol>
      
    </div>
    
    <div class="article-info article-info-index">
      
      <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/linux/">linux</a>
    </div>
      <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/cron/">cron</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux/">linux</a></li></ul>
    </div>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>
  
    <article id="post-python2安装" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/06/03/python2安装/" class="article-date">
      <time datetime="2017-06-03T06:07:30.000Z" itemprop="datePublished">2017-06-03</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        <h1 itemprop="name">
      <a class="article-title" href="/2017/06/03/python2安装/">python2安装</a>
    </h1>
      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="安装python2"><a href="#安装python2" class="headerlink" title="安装python2"></a>安装python2</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"> linux上编译安装python2.7.5</span><br><span class="line"></span><br><span class="line">1. 下载python2.7.5，保存到 /data/qtongmon/software</span><br><span class="line">http://www.python.org/ftp/python/</span><br><span class="line"></span><br><span class="line">2. 解压文件</span><br><span class="line">tar xvf Python-2.7.5.tar.bz2</span><br><span class="line"></span><br><span class="line">3. 创建安装目录</span><br><span class="line">mkdir /usr/local/python27</span><br><span class="line"></span><br><span class="line">4. 安装python</span><br><span class="line">./configure --prefix=/usr/local/python27</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line"></span><br><span class="line">5. 修改老版本的ln指向（注意：这里修改后，可能会影响yum的使用）</span><br><span class="line">mv /usr/bin/python /usr/bin/python2.4.3</span><br><span class="line">ln -s /usr/local/python27/bin/python /usr/bin/python</span><br><span class="line"></span><br><span class="line">参考:</span><br><span class="line">http://www.cnblogs.com/yuechaotian/archive/2013/06/03/3115482.html</span><br></pre></td></tr></table></figure>
<h2 id="安装pip及相关包"><a href="#安装pip及相关包" class="headerlink" title="安装pip及相关包"></a>安装pip及相关包</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">官方：</span><br><span class="line">https://pypi.python.org/pypi/pip</span><br><span class="line"></span><br><span class="line">参考：</span><br><span class="line">http://blog.csdn.net/my2010sam/article/details/18315687</span><br></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/python/">python</a>
    </div>
      <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/">python</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python2/">python2</a></li></ul>
    </div>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>
  
    <article id="post-python3安装" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/06/03/python3安装/" class="article-date">
      <time datetime="2017-06-03T04:07:30.000Z" itemprop="datePublished">2017-06-03</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        <h1 itemprop="name">
      <a class="article-title" href="/2017/06/03/python3安装/">python3安装</a>
    </h1>
      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="安装python35"><a href="#安装python35" class="headerlink" title="安装python35"></a>安装python35</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"> linux上编译安装python3.5</span><br><span class="line"> </span><br><span class="line">1、CentOS6.5 安装Python 的依赖包</span><br><span class="line"></span><br><span class="line">yum groupinstall &quot;Development tools&quot;</span><br><span class="line">yum install zlib-devel bzip2-devel openssl-devel ncurses-devel sqlite-devel readline-devel tk-devel gdbm-devel db4-devel libpcap-devel xz-devel</span><br><span class="line"></span><br><span class="line">2、下载Python3.5的源码包并编译</span><br><span class="line"></span><br><span class="line">wget https://www.python.org/ftp/python/3.5.0/Python-3.5.0.tgz</span><br><span class="line">tar xf Python-3.5.0.tgz</span><br><span class="line">cd Python-3.5.0</span><br><span class="line">./configure --prefix=/usr/local --enable-shared</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">ln –s /usr/local/bin/python3 /usr/bin/python3</span><br><span class="line"></span><br><span class="line">3、在运行Python之前需要配置库：</span><br><span class="line"></span><br><span class="line">echo /usr/local/lib &gt;&gt; /etc/ld.so.conf.d/local.conf</span><br><span class="line">ldconfig</span><br><span class="line"></span><br><span class="line">4、运行演示：</span><br><span class="line"></span><br><span class="line">python3 --version</span><br><span class="line">Python 3.5.0</span><br><span class="line"></span><br><span class="line">5、删除编译Python时所需要的库</span><br><span class="line"></span><br><span class="line">yum groupremove &quot;Development tools&quot; --remove-leaveas</span><br><span class="line">yum remove zlib-devel bzip2-devel openssl-devel ncurses-devel sqlite-devel readline-devel tk-devel gdbm-devel db4-devel libpcap-devel xz-devel --remove-leaves</span><br><span class="line"></span><br><span class="line">6、设置别名方便使用</span><br><span class="line"></span><br><span class="line">alias py=python3</span><br><span class="line"></span><br><span class="line">7、CentOS 安装easy_install、pip的方法            </span><br><span class="line"></span><br><span class="line">CentOS 安装easy_install的方法：</span><br><span class="line"></span><br><span class="line">wget -q http://peak.telecommunity.com/dist/ez_setup.py</span><br><span class="line">python ez_setup.py</span><br><span class="line">8、CentOS安装python包管理安装工具pip的方法如下：</span><br><span class="line"></span><br><span class="line">wget --no-check-certificate https://github.com/pypa/pip/archive/1.5.5.tar.gz</span><br><span class="line"></span><br><span class="line">注意：wget获取https的时候要加上：--no-check-certificate</span><br><span class="line"></span><br><span class="line">tar zvxf 1.5.5    #解压文件</span><br><span class="line">cd pip-1.5.5/</span><br><span class="line">python3 setup.py install</span><br><span class="line"></span><br><span class="line">OK，这样就安装好pip了，</span><br><span class="line"></span><br><span class="line">下面来安装 requests吧。</span><br><span class="line"></span><br><span class="line">pip3 install requests</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">参考:</span><br><span class="line">http://blog.csdn.net/shaobingj126/article/details/50290359</span><br></pre></td></tr></table></figure>
<h3 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">1.Python3.5 installation fails: cannot open libpython3.5m.so.1.0</span><br><span class="line"></span><br><span class="line">export LD_LIBRARY_PATH=/usr/lib/</span><br><span class="line"></span><br><span class="line">http://stackoverflow.com/questions/38256696/python3-5-installation-fails-cannot-open-libpython3-5m-so-1-0</span><br></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/python/">python</a>
    </div>
      <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/">python</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python3/">python3</a></li></ul>
    </div>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>
  
    <article id="post-系统（功能）设计的一些思考——方法篇" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/05/31/系统（功能）设计的一些思考——方法篇/" class="article-date">
      <time datetime="2017-05-31T14:17:12.000Z" itemprop="datePublished">2017-05-31</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        <h1 itemprop="name">
      <a class="article-title" href="/2017/05/31/系统（功能）设计的一些思考——方法篇/">系统（功能）设计的一些思考——方法篇</a>
    </h1>
      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <ul>
<li><strong>说明</strong>：本文讨论的系统设计侧重于需求已经明确下的系统功能设计。</li>
</ul>
<p>上一篇文章，我根据系统设计的实践，列举了系统设计过程中存在的一些问题。众所周知，在工业生产中，采用成熟的方法制造产品一般来说质量会更可靠。系统设计到了现在也与工业生产类似，采用成熟规则的设计方法才能保证系统的质量，避免跟着感觉走所带来的风险。我一直相信做任何事情之前一定要有方法论，根据方法论来做事，事情做成的可能性才更高。</p>
<p>这里我抛砖引玉，简述我所习得的系统设计的方法，一起探讨有什么好的办法能够提高系统设计质量。</p>
<p>一般来说系统设计过程可以分为以下5个过程。</p>
<h3 id="1-列举场景"><a href="#1-列举场景" class="headerlink" title="1. 列举场景"></a>1. 列举场景</h3><hr>
<p>拿到一个设计需求，我们首先应该要列举所有用例，并且根据业务需求重要性进行排序，最终确认最核心的1-2个CASE。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">以音乐电台为例，列举其用例：</span><br><span class="line">注册/登陆</span><br><span class="line">播放音乐</span><br><span class="line">音乐推荐</span><br><span class="line">通过对业务进行分析不难得出，播放音乐是其最核心的需求，</span><br><span class="line">对播放音乐需求进行拆分，播放音乐步骤如下：</span><br><span class="line">获取频道列表</span><br><span class="line">选择频道</span><br><span class="line">播放音乐</span><br></pre></td></tr></table></figure>
<h3 id="2-分析限制条件"><a href="#2-分析限制条件" class="headerlink" title="2. 分析限制条件"></a>2. 分析限制条件</h3><hr>
<p>限制条件主要是指一些非功能需求的约束，比如说用户量，日活跃用户量，性能要求等。</p>
<p>对于限制条件的分析，我们需要评估它对系统功能的影响。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">接上面的例子，我们首先需要了解需求的一些关键信息，然后据此来进行评估。</span><br><span class="line">假定电台的日活跃用户为100，000</span><br><span class="line">那我们据此就可以进行 用户量，流量，内存使用量的评估</span><br><span class="line">用户量：</span><br><span class="line">并发用户量：100,000/5 = 20,000</span><br><span class="line">峰值用户量：20,000 * 3 = 60,000</span><br><span class="line">一段时间后峰值用户：60,000*10 = 600,000</span><br><span class="line">流量：</span><br><span class="line">每个用户请求播放音乐量：1首/分钟</span><br><span class="line">音乐平均大小：3MB</span><br><span class="line">峰值流量：600,000 * 3MB/60 = 30GB每秒</span><br><span class="line">内存：</span><br><span class="line">每个用户内存量：10KB</span><br><span class="line">每日最大内存量：100,000 * 10 * 10 = 10GB</span><br></pre></td></tr></table></figure>
<h3 id="3-应用服务设计"><a href="#3-应用服务设计" class="headerlink" title="3. 应用服务设计"></a>3. 应用服务设计</h3><hr>
<p>应用服务设计主要方法是根据用例，进行服务的概要设计，并对服务进行整合。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">接上例</span><br><span class="line">注册/登陆，播放音乐，音乐推荐这3个用例，</span><br><span class="line">我们可以需要设计3个不同的服务。</span><br><span class="line">分别叫User Service, Channel Service, Music Sevice，</span><br><span class="line">同时我们对服务进行整合，提供一个接待/代理的服务，对用户的请求进行路由，过滤等。</span><br></pre></td></tr></table></figure>
<h3 id="4-设计数据结构与存储"><a href="#4-设计数据结构与存储" class="headerlink" title="4. 设计数据结构与存储"></a>4. 设计数据结构与存储</h3><hr>
<p>根据应用服务设计进行数据存储与结构的设计。此阶段主要对数据存储进行选择与明细，同时具体设计数据存储结构。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">接上例子</span><br><span class="line">User Service由于存储的是用户信息，需要持久保持，更新、修改比较频繁且强调一致性，原子性，</span><br><span class="line">所以我们选用关系型数据库Mysql存储。</span><br><span class="line">Channel Service 对一致性的要求没有那么高，且经常需要查询读取，</span><br><span class="line">我们考虑用No-sql数据库如MongoDB进行存储。</span><br><span class="line">Music Service存储的是音乐的文件数据，我们直接用文件系统进行存储即可。</span><br></pre></td></tr></table></figure>
<h3 id="5-扩展优化"><a href="#5-扩展优化" class="headerlink" title="5. 扩展优化"></a>5. 扩展优化</h3><hr>
<p>扩展优化主要是根据业务的发展需求，在系统设计质量，广度，深度三个方面进行扩展。</p>
<p>质量主要提现在更好的性能等，在用户更多，或者文件更大的情况下，通过设计保证性能</p>
<p>广度体现在更多的功能需求需要进行满足</p>
<p>深度体现在更加复杂的业务逻辑进行处理</p>
<p>根据设计与需求进行评估，重复上面的步骤达到扩展优化的目标。</p>
      
    </div>
    
    <div class="article-info article-info-index">
      
      <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/设计/">设计</a>
    </div>
      <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/系统设计/">系统设计</a></li></ul>
    </div>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>
  
    <article id="post-系统（功能）设计的一些思考——问题篇" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/05/28/系统（功能）设计的一些思考——问题篇/" class="article-date">
      <time datetime="2017-05-28T14:07:12.000Z" itemprop="datePublished">2017-05-28</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        <h1 itemprop="name">
      <a class="article-title" href="/2017/05/28/系统（功能）设计的一些思考——问题篇/">系统（功能）设计的一些思考——问题篇</a>
    </h1>
      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <ul>
<li><strong>说明</strong>：本文讨论的系统设计侧重于需求已经明确下的系统功能设计。</li>
</ul>
<h3 id="1-系统设计概述"><a href="#1-系统设计概述" class="headerlink" title="1. 系统设计概述"></a>1. 系统设计概述</h3><hr>
<p>按照百度百科的定义，系统设计是新系统的物理设计阶段，是指按照需求分析阶段输出的系统功能需求、逻辑模型，在用户环境条件下设计出一个可以实施的方案。</p>
<p>根据一般的业务实践，系统设计的过程中需要定义系统架构、组件、模块、接口和数据来满足特定需求。其中所指的系统架构主要是指系统的技术架构，是广义上所讲的架构中一个部分，关于架构的内容在这里就不展开了。</p>
<p>概括一下，系统设计处于需要分析与系统开发阶段中间，是连接两者的纽带，关系到需求的满足与实施。通常来讲，好的设计需要满足，分阶段开发、易用性、可扩展性、业务完整性、业务规范性等原则。</p>
<h3 id="2-系统设计产出"><a href="#2-系统设计产出" class="headerlink" title="2. 系统设计产出"></a>2. 系统设计产出</h3><hr>
<p>系统设计有这么丰富的内容，也需要有相应的产出，用于指导系统开发过程。通常来讲，产出主要包括系统概要设计和系统详细设计二部分的内容，有时候我们也会合二为一。</p>
<h3 id="3-系统设计实践"><a href="#3-系统设计实践" class="headerlink" title="3.系统设计实践"></a>3.系统设计实践</h3><hr>
<p>系统设计需要有这么多的产出，那我们通过怎样来获得这些产出呢，又是如何来确认这些产出是合适的呢。根据笔者的不算丰富的工作经验（主要在业务系统领域），对大多数程序研发人员来说，我们会根据公司的要求的产出物进行交付，简单点说就是公司QA或者领导要求有什么产出，我们就给出相应的东西，通常是文档。实际上写文档的过程就是一个思考设计的过程，但每个人可能是根据自己的经验、习惯以及对需求的认知来进行设计。</p>
<p>我们仔细想一想，上面这种模式下，存在哪些问题？这里我大致列举了几点：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1）根据设计人员本身的经验，产出交付物质量参差不齐，影响开发</span><br><span class="line">2）依赖公司QA或者领导对于交付物的定义，目的不是为了用于开发，而是交差</span><br><span class="line">3）每个人甚至每次的设计方法都不一样，容易有所遗漏，影响交付</span><br><span class="line">4）对于一些业务上看似简单的部分，通常会忽略设计，往往会出现问题</span><br></pre></td></tr></table></figure>
<p>以上几点，都会影响系统设计结果好坏。系统研发实践表明，在整个系统生命周期中，越到后期纠偏改动的成本越高。系统设计相对来说处于整个生命周期的早期，提高系统设计质量具有重大的意义。</p>
<p>那么有没有什么办法能够提高系统设计质量，是否系统设计质只量能依赖设计人员的经验与能力呢？</p>
      
    </div>
    
    <div class="article-info article-info-index">
      
      <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/设计/">设计</a>
    </div>
      <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/系统设计/">系统设计</a></li></ul>
    </div>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>
  
    <article id="post-gitflow应用规范说明" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/05/28/gitflow应用规范说明/" class="article-date">
      <time datetime="2017-05-28T02:07:30.000Z" itemprop="datePublished">2017-05-28</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        <h1 itemprop="name">
      <a class="article-title" href="/2017/05/28/gitflow应用规范说明/">git flow应用规范说明</a>
    </h1>
      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="git-flow应用规范说明"><a href="#git-flow应用规范说明" class="headerlink" title="git flow应用规范说明"></a>git flow应用规范说明</h1><p>我们前段时间从SVN切换到Git，经过培训与一段时间的使用，大家对git的基本使用比较熟悉，但对git flow还是不太熟练。下面就简单介绍一下各分支意义，以及开发过程中的应用场景。</p>
<h2 id="常用分支（流程默认）"><a href="#常用分支（流程默认）" class="headerlink" title="常用分支（流程默认）"></a>常用分支（流程默认）</h2><ul>
<li><p>Master 分支(Production)</p>
<p>  最近发布到生产环境的代码，最近发布的Release， 这个分支只能从其他分支合并，不能在这个分支直接修改</p>
</li>
<li><p>Develop 分支</p>
<p>  开发分支，包含所有要发布到下一个Release的代码，这个主要合并与其他分支，比如Feature分支</p>
</li>
<li><p>Feature 分支</p>
<p>  新的功能分支，开发完成后，合并回Develop分支进入下一个Release</p>
</li>
<li><p>Release 分支</p>
<p>  发布一个新Release的时，我们基于Develop分支创建一个Release分支，完成Release后，我们合并到Master和Develop分支</p>
</li>
<li><p>Hotfix 分支</p>
<p>  生产上发现新的Bug时候，我们需要创建一个Hotfix, 完成Hotfix后，我们合并回Master和Develop分支，所以Hotfix的改动会进入下一个Release</p>
</li>
</ul>
<h2 id="实际项目阶段应用"><a href="#实际项目阶段应用" class="headerlink" title="实际项目阶段应用"></a>实际项目阶段应用</h2><h3 id="1-初始项目"><a href="#1-初始项目" class="headerlink" title="1. 初始项目"></a>1. 初始项目</h3><ul>
<li>建立Master,Develop分支。</li>
<li>Master分支为锁定状态，开发人员无权限操作。从服务器上clone之后，默认切换到Develop分支。</li>
<li>此步由Master管理员完成。</li>
</ul>
<h3 id="2-功能开发（相对独立，较大功能）"><a href="#2-功能开发（相对独立，较大功能）" class="headerlink" title="2. 功能开发（相对独立，较大功能）"></a>2. 功能开发（相对独立，较大功能）</h3><ul>
<li>开发功能时，在本地建立Feature分支，完成功能开发测试后，合并加Develop分支。</li>
<li>此步为开发人员自行完成。</li>
</ul>
<h3 id="3-生产发布（正常版本）"><a href="#3-生产发布（正常版本）" class="headerlink" title="3. 生产发布（正常版本）"></a>3. 生产发布（正常版本）</h3><ul>
<li>基本完成所有功能开发，准备交付测试时。建立Release分支,在此分支上进行bug的修改与少量小功能的增加优化。</li>
<li>到版本发布前，所有修改在此分支进行，不属于此版本的功能增加，切换回Develop分支参考第2种情况进行。</li>
<li>版本发布后，合并分支到Develop和Master,并在Master分支打tag为release-v1.x.x</li>
<li>合并与tag建立由Master管理员完成。</li>
</ul>
<h3 id="4-生产紧急bug修复-包括紧急功能增加"><a href="#4-生产紧急bug修复-包括紧急功能增加" class="headerlink" title="4. 生产紧急bug修复(包括紧急功能增加)"></a>4. 生产紧急bug修复(包括紧急功能增加)</h3><ul>
<li>从Master分支创建Hotfix分支。</li>
<li>完成问题修改后，合并回Master和Develop分支，建议删除此分支并做tag。</li>
<li>合并与tag建立由Master管理员完成。</li>
</ul>
<hr>
<p>参考：<br><a href="http://www.cnblogs.com/cnblogsfans/p/5075073.html" target="_blank" rel="external">git flow guide</a></p>
      
    </div>
    
    <div class="article-info article-info-index">
      
      <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/版本控制/">版本控制</a>
    </div>
      <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Git/">Git</a></li></ul>
    </div>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>
  
    <article id="post-设计模式之单例模式" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/05/22/设计模式之单例模式/" class="article-date">
      <time datetime="2017-05-22T14:07:12.000Z" itemprop="datePublished">2017-05-22</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        <h1 itemprop="name">
      <a class="article-title" href="/2017/05/22/设计模式之单例模式/">设计模式之单例模式</a>
    </h1>
      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="设计模式之单例模式"><a href="#设计模式之单例模式" class="headerlink" title="设计模式之单例模式"></a>设计模式之单例模式</h2><h3 id="模式介绍"><a href="#模式介绍" class="headerlink" title="模式介绍"></a>模式介绍</h3><hr>
<blockquote>
<p>单例模式，顾名思义用于保证类只有单独的实例，当然是在同一jvm与classloader前提下。</p>
</blockquote>
<h3 id="模式应用"><a href="#模式应用" class="headerlink" title="模式应用"></a>模式应用</h3><hr>
<blockquote>
<p>通常最常见的单例模式应该在配置文件的读取，内存缓存的使用以及new 对象开销很大的情况。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">通常，在应用中，配置文件的读取是一次性获取配置文件中所有的key/value对并放入对象中</span><br><span class="line">，我们获取单独的一个配置项，从对象中通过key获取即可。</span><br><span class="line">这个对象只需要一个实例就好了，</span><br><span class="line">如果每次获取一个配置项都需要new 一个对象，</span><br><span class="line">那所有的配置信息都会随着对象的创建加载到内存中，</span><br><span class="line">这势必会导致内存的不必要开支，浪费。</span><br></pre></td></tr></table></figure>
<h3 id="模式的类图"><a href="#模式的类图" class="headerlink" title="模式的类图"></a>模式的类图</h3><hr>
<p>略</p>
<h3 id="模式的实现"><a href="#模式的实现" class="headerlink" title="模式的实现"></a>模式的实现</h3><hr>
<p>单例模式的java实现一般有3种形式</p>
<ul>
<li>饿汉式</li>
<li>懒汉式</li>
<li>双重检查式</li>
</ul>
<p>3种形式各有特色与优势。</p>
<ol>
<li>饿汉式</li>
</ol>
<blockquote>
<p>利用static关键字与jvm的特性，在类实例化之前就已经产生类变量（final）存储类自己的对象。getInstance方法直接返回此对象即可</p>
</blockquote>
<blockquote>
<p>存在的问题：不管有没有用到对象都会被实例化，可能造成一定的浪费</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">public class IvyTower &#123;</span><br><span class="line">    private IvyTower() &#123;    &#125;</span><br><span class="line"></span><br><span class="line">    private final static IvyTower instance = new IvyTower();</span><br><span class="line"></span><br><span class="line">    public static IvyTower getInstance() &#123;</span><br><span class="line">        return instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>懒汉式</li>
</ol>
<blockquote>
<p>所谓懒汉其实应该叫延迟加载（lazy load）比较恰当，这种用法也经常在编码中被使用到，用于节约系统资源，只有在需要时才会被实例化。</p>
</blockquote>
<blockquote>
<p>存在问题：在并发的情况下，需要使用synchroized关键字对方法进行同步，降低了性能</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">public class ThreadSafeLazyLoadIvyTower &#123;</span><br><span class="line"></span><br><span class="line">    private static ThreadSafeLazyLoadIvyTower instance;</span><br><span class="line"></span><br><span class="line">    private ThreadSafeLazyLoadIvyTower()&#123;    &#125;</span><br><span class="line"></span><br><span class="line">    public static synchronized ThreadSafeLazyLoadIvyTower getInstance() &#123;</span><br><span class="line">        if(instance == null) &#123;</span><br><span class="line">            instance = new ThreadSafeLazyLoadIvyTower();</span><br><span class="line">        &#125;</span><br><span class="line">        return instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>双重检查式</li>
</ol>
<blockquote>
<p>双重检查double-check，我的理解是在懒汉式的基础上进行了一些性能的改进，让整个方法不再属于同步块中，提升了一定的性能。</p>
</blockquote>
<blockquote>
<p>由于低版本JVM对于volatile关键字的实现有问题，此方法只有在jdk1.5以上版本可行</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">public class DoubleCheckIvyTower &#123;</span><br><span class="line"></span><br><span class="line">    private DoubleCheckIvyTower() &#123;    &#125;</span><br><span class="line"></span><br><span class="line">    private static volatile DoubleCheckIvyTower instance;</span><br><span class="line"></span><br><span class="line">    public static DoubleCheckIvyTower getInstance() &#123;</span><br><span class="line">        DoubleCheckIvyTower result = instance;</span><br><span class="line">        if(result == null) &#123;</span><br><span class="line">            synchronized (DoubleCheckIvyTower.class) &#123;</span><br><span class="line">                result = instance;</span><br><span class="line"></span><br><span class="line">                if(result == null) &#123;</span><br><span class="line">                    result = instance = new DoubleCheckIvyTower();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="模式扩展"><a href="#模式扩展" class="headerlink" title="模式扩展"></a>模式扩展</h3><p>单例模式看似简单，但其中涉及到知识点，特别是和语言相关的特性还是比较多， 需要我们仔细的去揣摩，应用，理解。</p>
<p>参考：<br><a href="https://my.oschina.net/xianggao/blog/616385" target="_blank" rel="external">https://my.oschina.net/xianggao/blog/616385</a></p>
      
    </div>
    
    <div class="article-info article-info-index">
      
      <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/设计模式/">设计模式</a>
    </div>
      <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/设计模式/">设计模式</a></li></ul>
    </div>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>
  
    <article id="post-架构设计原则概述" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/05/14/架构设计原则概述/" class="article-date">
      <time datetime="2017-05-14T12:07:12.000Z" itemprop="datePublished">2017-05-14</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        <h1 itemprop="name">
      <a class="article-title" href="/2017/05/14/架构设计原则概述/">架构设计原则概述</a>
    </h1>
      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="架构设计原则概述"><a href="#架构设计原则概述" class="headerlink" title="架构设计原则概述"></a>架构设计原则概述</h2><h3 id="什么是架构设计"><a href="#什么是架构设计" class="headerlink" title="什么是架构设计"></a>什么是架构设计</h3><hr>
<ul>
<li>架构设计是连接业务需求与研发的纽带，业务的需求需要经过抽象的架构设计之后才能进行后续的研发工作。</li>
</ul>
<ul>
<li>架构设计的主要职责，将业务需求转换为规范的开发计划及文本，并产生项目的总体架构，指导整个团队完成这个计划。架构设计是软件设计过程的早期阶段，它把需求分析与设计流程连接在一起。</li>
</ul>
<h3 id="架构设计的主要产出"><a href="#架构设计的主要产出" class="headerlink" title="架构设计的主要产出"></a>架构设计的主要产出</h3><hr>
<ul>
<li>根据业务需求的理解，产生顶层的架构设计图</li>
</ul>
<blockquote>
<p>架构设计图，类比于建筑设计中的蓝图指导后续工作<br>架构设计图需要清晰表达架构师头脑中的清晰的设计目标</p>
</blockquote>
<ul>
<li>优秀的架构设计是随着技术进步，需求完善逐步演进而来。</li>
</ul>
<h3 id="架构设计的一些原则"><a href="#架构设计的一些原则" class="headerlink" title="架构设计的一些原则"></a>架构设计的一些原则</h3><hr>
<ul>
<li>软件项目的最终目标是要产生一个可维护的系统，架构设计就是要保障这种可维护性。</li>
</ul>
<blockquote>
<p>在架构设计中，着重需要考虑以下个方面：<br>安全性、可靠性、可维护性、易用性、可扩展性、市场因素</p>
</blockquote>
<ul>
<li>“高内聚，低耦合”是保障可维护性的重要途径，同时也是在顶层架构设计，系统模块设计，系统编码时应该遵守的原则。</li>
</ul>
<ul>
<li>在顶层架构设计中，通过以下方式来保证：</li>
</ul>
<p>1.异步解耦，降低整个系统复杂性<br>2.分布式服务提高内聚性与复用性<br>3.微服务设计降低耦合性<br>4.按功能划分子系统，降低子系统的复杂性，提高子系统可复用性<br>5.分层架构清晰，增加可维护性与可复用性<br>6.利用中间件技术，降低复杂性，提高复用性</p>
      
    </div>
    
    <div class="article-info article-info-index">
      
      <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/架构/">架构</a>
    </div>
      <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/架构/">架构</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/设计/">设计</a></li></ul>
    </div>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>
  
    <article id="post-关于代码质量的思考和重构" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/04/15/关于代码质量的思考和重构/" class="article-date">
      <time datetime="2017-04-15T03:07:30.000Z" itemprop="datePublished">2017-04-15</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        <h1 itemprop="name">
      <a class="article-title" href="/2017/04/15/关于代码质量的思考和重构/">关于代码质量的思考和重构</a>
    </h1>
      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
              <h3 id="关于代码质量的思考-amp-重构"><a href="#关于代码质量的思考-amp-重构" class="headerlink" title="关于代码质量的思考&amp;重构"></a>关于代码质量的思考&amp;重构</h3><h4 id="1-程序构成"><a href="#1-程序构成" class="headerlink" title="1. 程序构成"></a>1. 程序构成</h4><ul>
<li><p>程序=源码+文档</p>
          
      
    </li></ul></div>
    
    <div class="article-info article-info-index">
      
      <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/重构/">重构</a>
    </div>
      <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/代码质量/">代码质量</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/重构/">重构</a></li></ul>
    </div>
      
        <p class="article-more-link">
          <a href="/2017/04/15/关于代码质量的思考和重构/#more">more >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>
  
    <article id="post-redis集群相关概念" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/03/15/redis集群相关概念/" class="article-date">
      <time datetime="2017-03-15T03:07:30.000Z" itemprop="datePublished">2017-03-15</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        <h1 itemprop="name">
      <a class="article-title" href="/2017/03/15/redis集群相关概念/">redis集群笔记</a>
    </h1>
      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
              <h3 id="redis集群笔记"><a href="#redis集群笔记" class="headerlink" title="redis集群笔记"></a>redis集群笔记</h3><h4 id="普通hash"><a href="#普通hash" class="headerlink" title="普通hash"></a>普通hash</h4>
          
      
    </div>
    
    <div class="article-info article-info-index">
      
      <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/缓存/">缓存</a>
    </div>
      <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/redis/">redis</a></li></ul>
    </div>
      
        <p class="article-more-link">
          <a href="/2017/03/15/redis集群相关概念/#more">more >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>
  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
    </nav></div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                <i class="fa fa-copyright"></i> 
                2016-2018 Zane.Xie
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank" title="快速、简洁且高效的博客框架">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="简而不减 Hexo 双栏博客主题  v3.5">Yelee</a> by MOxFIVE <i class="fa fa-heart animated infinite pulse"></i>
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style="display:none">
                        <span id="site-visit" title="本站到访数"><i class="fa fa-user" aria-hidden="true"></i><span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>| </span>
                
                
                    <span id="busuanzi_container_page_pv" style="display:none">
                        <span id="page-visit" title="本页阅读量"><i class="fa fa-eye animated infinite pulse" aria-hidden="true"></i><span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>
    </div>
    <script data-main="/js/main.js" src="//cdn.bootcss.com/require.js/2.2.0/require.min.js"></script>
<script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 5;
                var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>



<div class="scroll" id="scroll">
    <a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" onclick="load$hide()" title="查看评论"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    // Open in New Window
    
        var oOpenInNew = {
            
            
            
            
            
            
             archives: ".archive-article-title", 
             miniArchives: "a.post-list-link", 
            
             friends: "#js-friends a", 
             socail: ".social a" 
        }
        for (var x in oOpenInNew) {
            $(oOpenInNew[x]).attr("target", "_blank");
        }
    
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
</body>
